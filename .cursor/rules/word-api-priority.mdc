---
alwaysApply: true
description: Word APIä¼˜å…ˆåŸåˆ™å’ŒWordAPIHelperä½¿ç”¨æŒ‡å—
globs: *.cs
---

# Word API ä¼˜å…ˆåŸåˆ™å’Œ WordAPIHelper ä½¿ç”¨æŒ‡å—

## æ ¸å¿ƒåŸåˆ™

**æ‰€æœ‰ä¸Wordç›¸å…³çš„åŠŸèƒ½å¿…é¡»ä¼˜å…ˆä½¿ç”¨Word APIï¼Œå¹¶é€šè¿‡WordAPIHelper.csç»Ÿä¸€ç®¡ç†**

## å¿…é¡»éµå¾ªçš„è§„åˆ™

### 1. Word API ä¼˜å…ˆä½¿ç”¨
- âœ… **ä¼˜å…ˆä½¿ç”¨**: `Microsoft.Office.Interop.Word` API
- âŒ **é¿å…ä½¿ç”¨**: ç¡¬ç¼–ç çš„æ•°å€¼ã€è‡ªå®šä¹‰è®¡ç®—ã€ç¬¬ä¸‰æ–¹åº“
- ğŸ“ **å‚è€ƒæ–‡ä»¶**: [WordAPIHelper.cs](mdc:WordAPIHelper.cs)

### 2. å•ä½è½¬æ¢å¿…é¡»ä½¿ç”¨Word API
```csharp
// âœ… æ­£ç¡® - ä½¿ç”¨Word API
decimal centimeters = (decimal)app.PointsToCentimeters(points);
float points = app.CentimetersToPoints(centimeters);

// âŒ é”™è¯¯ - ç¡¬ç¼–ç è½¬æ¢
decimal centimeters = points * 0.0352778f; // ä¸è¦è¿™æ ·åš
```

### 3. å­—ä½“å’Œæ ·å¼å¿…é¡»é€šè¿‡Word API
```csharp
// âœ… æ­£ç¡® - ä½¿ç”¨WordAPIHelper
var fonts = WordAPIHelper.GetSystemFonts();
var fontSizes = WordAPIHelper.GetFontSizes();
float fontSize = WordAPIHelper.ConvertFontSize(sizeText);

// âŒ é”™è¯¯ - ç›´æ¥ä½¿ç”¨ç³»ç»Ÿå­—ä½“
var fonts = System.Drawing.FontFamily.Families; // ä¸è¦è¿™æ ·åš
```

### 4. æ•°å€¼è¾“å…¥æ§ä»¶å¿…é¡»é›†æˆWord API
å‚è€ƒ [MultiLevelList.cs](mdc:MultiLevelList.cs) ä¸­çš„ `NumericUpDownWithUnit` ç±»ï¼š
```csharp
// âœ… æ­£ç¡® - æ„é€ å‡½æ•°æ¥å—Word Application
public NumericUpDownWithUnit(Microsoft.Office.Interop.Word.Application wordApp = null, UnitType unit = UnitType.Centimeters)

// âœ… æ­£ç¡® - ä½¿ç”¨Word APIè¿›è¡Œå•ä½è½¬æ¢
public decimal ValueInCentimeters
{
    get
    {
        switch (_currentUnit)
        {
            case UnitType.Characters:
                return ConvertCharactersToCentimeters(Value);
            case UnitType.Centimeters:
                return Value;
            case UnitType.Points:
                return (decimal)_wordApp.PointsToCentimeters((float)Value);
        }
    }
}
```

### 5. å¿…é¡»ä½¿ç”¨WordAPIHelperçš„æ–¹æ³•
```csharp
// âœ… æ­£ç¡® - ä½¿ç”¨WordAPIHelperç»Ÿä¸€ç®¡ç†
var app = WordAPIHelper.GetWordApplication();
var doc = WordAPIHelper.GetActiveDocument();
var fonts = WordAPIHelper.GetSystemFonts();
var fontSizes = WordAPIHelper.GetFontSizes();
float convertedSize = WordAPIHelper.ConvertFontSize("12");
float convertedUnits = WordAPIHelper.ConvertUnits("10", "å˜ç±³", "ç£…");
```

### 6. é”™è¯¯å¤„ç†å¿…é¡»åŒ…å«Word APIå¼‚å¸¸
```csharp
try
{
    // ä½¿ç”¨Word API
    var result = app.SomeWordAPIMethod();
}
catch (Exception ex)
{
    throw new Exception($"Word APIè°ƒç”¨å¤±è´¥ï¼š{ex.Message}");
}
```

## ç¦æ­¢çš„åšæ³•

### âŒ ä¸è¦ç¡¬ç¼–ç è½¬æ¢å€¼
```csharp
// é”™è¯¯ç¤ºä¾‹
float points = centimeters * 28.35f; // ä¸è¦ç¡¬ç¼–ç 
decimal charWidth = fontSize * 0.5m; // ä¸è¦ä¼°ç®—
```

### âŒ ä¸è¦ç›´æ¥ä½¿ç”¨ç³»ç»ŸAPIæ›¿ä»£Word API
```csharp
// é”™è¯¯ç¤ºä¾‹
var installedFonts = new System.Drawing.Text.InstalledFontCollection(); // ä¸è¦ç›´æ¥ä½¿ç”¨
var font = new System.Drawing.Font(fontName, size); // ä¸è¦ç›´æ¥åˆ›å»º
```

### âŒ ä¸è¦ç»•è¿‡WordAPIHelper
```csharp
// é”™è¯¯ç¤ºä¾‹
var app = Globals.ThisAddIn.Application; // ä¸è¦ç›´æ¥è·å–
var doc = app.ActiveDocument; // ä¸è¦ç›´æ¥è®¿é—®
```

## æ¨èçš„åšæ³•

### âœ… ä½¿ç”¨WordAPIHelperç»Ÿä¸€ç®¡ç†
```csharp
// æ¨èåšæ³•
var app = WordAPIHelper.GetWordApplication();
var doc = WordAPIHelper.GetActiveDocument();
var fonts = WordAPIHelper.GetSystemFonts();
```

### âœ… åœ¨è‡ªå®šä¹‰æ§ä»¶ä¸­é›†æˆWord API
```csharp
// æ¨èåšæ³• - å‚è€ƒNumericUpDownWithUnit
public class CustomControl : Control
{
    private Microsoft.Office.Interop.Word.Application _wordApp;
    
    public CustomControl(Microsoft.Office.Interop.Word.Application wordApp = null)
    {
        _wordApp = wordApp ?? WordAPIHelper.GetWordApplication();
    }
}
```

### âœ… ä½¿ç”¨Word APIè¿›è¡Œç²¾ç¡®è®¡ç®—
```csharp
// æ¨èåšæ³•
private decimal ConvertCharactersToCentimeters(decimal characters)
{
    try
    {
        if (_wordApp?.Selection?.Range?.Font?.Size != null)
        {
            float fontSize = _wordApp.Selection.Range.Font.Size;
            // ä½¿ç”¨Word APIè®¡ç®—å­—ç¬¦å®½åº¦
            var tempRange = _wordApp.Selection.Range;
            // ... ä½¿ç”¨Word APIè¿›è¡Œç²¾ç¡®è®¡ç®—
        }
    }
    catch (Exception ex)
    {
        // ä½¿ç”¨Word APIçš„å¤‡ç”¨æ–¹æ¡ˆ
    }
}
```

## æ–‡ä»¶å¼•ç”¨

- **ä¸»è¦å·¥å…·ç±»**: [WordAPIHelper.cs](mdc:WordAPIHelper.cs) - ç»Ÿä¸€ç®¡ç†æ‰€æœ‰Word APIè°ƒç”¨
- **å®ç°ç¤ºä¾‹**: [MultiLevelList.cs](mdc:MultiLevelList.cs) - å±•ç¤ºå¦‚ä½•æ­£ç¡®é›†æˆWord API
- **è‡ªå®šä¹‰æ§ä»¶**: å‚è€ƒ `NumericUpDownWithUnit` ç±»çš„å®ç°æ–¹å¼

## æ£€æŸ¥æ¸…å•

åœ¨ç¼–å†™ä»»ä½•ä¸Wordç›¸å…³çš„ä»£ç æ—¶ï¼Œè¯·ç¡®ä¿ï¼š

1. âœ… ä½¿ç”¨äº† `Microsoft.Office.Interop.Word` API
2. âœ… é€šè¿‡ `WordAPIHelper` è·å–Wordåº”ç”¨ç¨‹åºå®ä¾‹
3. âœ… ä½¿ç”¨Word APIè¿›è¡Œå•ä½è½¬æ¢
4. âœ… ä½¿ç”¨Word APIè·å–å­—ä½“å’Œæ ·å¼ä¿¡æ¯
5. âœ… åœ¨è‡ªå®šä¹‰æ§ä»¶ä¸­é›†æˆäº†Word API
6. âœ… åŒ…å«äº†é€‚å½“çš„é”™è¯¯å¤„ç†
7. âœ… æ²¡æœ‰ç¡¬ç¼–ç çš„è½¬æ¢å€¼
8. âœ… æ²¡æœ‰ç»•è¿‡WordAPIHelperç›´æ¥è®¿é—®Wordå¯¹è±¡

**è®°ä½ï¼šWord APIä¼˜å…ˆï¼ŒWordAPIHelperç»Ÿä¸€ç®¡ç†ï¼Œç¡®ä¿æ‰€æœ‰åŠŸèƒ½éƒ½é€šè¿‡Word APIå®ç°ï¼**