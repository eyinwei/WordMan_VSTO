# WordMan 3.0 - 专业的 Word 文档处理插件

<div align="center">

**WordMan** 是一款专为 Microsoft Word 设计的 VSTO 增强插件，提供强大的文档处理、排版和编辑功能，让您的文档工作更加高效专业。

[![Version](https://img.shields.io/badge/version-3.0-blue.svg)](https://github.com/yourusername/wordman)
[![.NET](https://img.shields.io/badge/.NET-4.0-512BD4.svg)](https://dotnet.microsoft.com/)
[![Office](https://img.shields.io/badge/Office-2013+-D83B01.svg)](https://www.microsoft.com/microsoft-365)

</div>

---

## ✨ 功能概览

WordMan 3.0 将常用文档处理功能集成到一个统一的界面中，按功能模块划分为五个主要区域：

![主功能界面](功能介绍/fig1%20主功能.png)

### 📝 文本处理组

提供全面的文本编辑和格式化工具，帮助您快速清理和整理文档内容。

- **清除格式** - 一键清除选中文本的所有格式设置
- **格式刷** - 智能复制格式并应用到其他文本
- **只留文本** - 粘贴时自动清除格式，仅保留纯文本内容
- **去除断行** - 批量清除段落内的手动换行符
- **去除空格** - 智能删除多余的空格
- **去除空行** - 快速清除文档中的空白段落
- **缩进2字符** - 一键设置段落首行缩进为标准2字符
- **去除缩进** - 清除段落的所有缩进设置
- **英标转中标** - 自动将英文标点转换为中文标点
- **中标转英标** - 自动将中文标点转换为英文标点
- **自动加空格** - 在数字和单位之间智能添加空格（如：10cm → 10 cm）
- **字体替换** - 批量替换文档中的字体样式
  - 仿宋GB2312 → 仿宋
  - 楷体GB2312 → 楷体
  - 方正小标宋 → 黑体
  - 数字字母 → Times New Roman
- **希腊字母** - 提供完整的希腊字母表，支持大小写转换和快速插入，非常适合学术写作和数学公式编辑

![希腊字母工具](功能介绍/fig2%20希腊字母.png)

- **常用符号** - 分类整理的科学符号、数学符号、单位符号等，让符号输入变得简单高效

![常用符号工具](功能介绍/fig3%20常用符号.png)

### 📊 表格处理组

专业的表格创建和编辑工具，满足学术和办公文档的表格需求。

- **创建三线表** - 快速创建符合学术规范的标准三线表
- **设为三线** - 将现有表格一键转换为三线表格式
- **插入N行** - 批量插入指定数量的表格行（可选择在上方或下方）
- **插入N列** - 批量插入指定数量的表格列（可选择在左侧或右侧，自动调整列宽）
- **重复标题行** - 设置表格跨页时自动在每页顶部重复标题行

### 📈 题注与引用组

自动化图表编号和交叉引用管理，让您的文档更加规范专业。

- **图编号** - 为图片自动添加题注，支持三种编号样式：
  - `图 1` - 简单编号
  - `图 1-1` - 章节编号（连字符）
  - `图 1.1` - 章节编号（点号）
- **表编号** - 智能为表格自动添加题注，支持三种编号样式：
  - `表 1` - 简单编号
  - `表 1-1` - 章节编号（连字符）
  - `表 1.1` - 章节编号（点号）
  - **智能定位**：自动检测表格前是否有段落，智能插入题注位置，确保不会插入到表格单元格中
- **式编号** - 智能公式编号，使用表格布局实现公式居中、编号右对齐：
  - `（ 1 ）` - 简单编号
  - `（1-1）` - 章节编号（连字符）
  - `（1.1）` - 章节编号（点号）
- **交叉引用** - 快速插入对图、表或公式的交叉引用，支持智能识别和高亮显示

### 🖼️ 图片处理组

强大的图片处理工具，帮助您统一和管理文档中的图片。

- **宽度刷** - 快速统一多张图片的宽度
- **高度刷** - 快速统一多张图片的高度
- **位图化** - 将矢量图形转换为位图格式，防止在其他电脑上显示异常
- **导出图片** - 将文档中的图片以高清质量导出到指定位置

### 🎨 全文处理组

全面的文档样式和排版管理工具，让您的文档格式更加规范统一。

- **排版工具** - 打开排版工具任务窗格，集成常用排版功能

![排版工具](功能介绍/fig4%20排版工具.png)

- **样式设置** - 全面的文档样式管理，支持样式预设、导入导出和批量修改

![样式设置](功能介绍/fig5%20样式设置.png)

- **多级列表** - 强大的多级列表创建工具，支持9级标题的详细配置

![多级列表](功能介绍/fig6%20多级列表.png)

![多级列表段落设置](功能介绍/fig7%20多级列表段落设置.png)
- **域名高亮** - 高亮显示文档中的所有交叉引用和文献引用
- **取消高亮** - 取消引用字段的高亮显示
- **文献编号** - 设置文献引用的显示格式（上标/正常）
- **另存PDF** - 将文档另存为PDF格式
- **文档操作** - 文档合并和拆分工具
- **快速密级** - 快速添加或移除文档密级标签（公开/内部）

---

## 🚀 快速开始

### 系统要求

- **操作系统**：Windows 7 或更高版本
- **Office版本**：Microsoft Office 2013 或更高版本
- **.NET框架**：.NET Framework 4.0 或更高版本

### 安装步骤

1. **下载安装包**
   - 从发布页面下载 WordMan 3.0 安装包

2. **安装插件**
   - 运行安装程序，按照提示完成安装
   - 确保已关闭所有 Word 窗口

3. **启动 Word**
   - 打开 Microsoft Word
   - 在功能区顶部找到"WordMan"选项卡

4. **开始使用**
   - 点击"WordMan"选项卡即可使用所有功能

### 使用示例

#### 示例 1：创建三线表

1. 将光标放在要插入表格的位置
2. 点击"创建三线表"按钮
3. 系统会自动创建一个3×3的标准三线表

#### 示例 2：插入图编号

1. 选中图片或将光标放在图片后
2. 在"图编号"下拉菜单中选择编号样式
3. 点击"图编号"按钮
4. 系统会在图片下方自动插入带编号的图题

![题注功能演示](功能介绍/fig9%20插入图片、表格、公式题注功能演示.gif)

#### 示例 3：插入表编号

1. 将光标放在表格中任意位置
2. 在"表编号"下拉菜单中选择编号样式
3. 点击"表编号"按钮
4. 系统会智能检测表格前是否有段落：
   - 如果表格前有文本段落，会在该段落末尾插入题注段落
   - 如果表格前是空段落，会直接使用该空段落
   - 如果表格前没有段落（页面开始就是表格），会在表格前插入新段落
5. 题注会自动插入到表格前的正确位置，不会插入到表格单元格中

#### 示例 4：公式编号

1. 将光标放在包含公式的段落中
2. 在"式编号"下拉菜单中选择编号样式
3. 点击"式编号"按钮
4. 系统会使用表格布局创建公式居中、编号右对齐的效果
5. 如果公式前有空行，空行会被保留，不会删除

#### 示例 5：批量插入表格列

1. 将光标放在表格中
2. 点击"插入N列"按钮
3. 在弹出的对话框中输入要插入的列数
4. 选择插入方向（左侧/右侧）
5. 系统会自动插入列并调整列宽以适应页面

![表格功能演示](功能介绍/fig8%20创建表格_更换表格功能演示.gif)

#### 示例 6：快速交叉引用

1. 点击"交叉引用"按钮进入交叉引用模式
2. 将光标移动到要引用的题注所在行
3. 系统会自动在原始位置插入交叉引用
4. 按 ESC 键或再次点击按钮退出交叉引用模式

![交叉引用功能演示](功能介绍/fig10%20快速交叉引用功能演示.gif)

---

## 💡 核心特性

### 智能操作

- **一键撤销** - 所有操作都支持单步撤销，操作更加安全
- **智能识别** - 自动识别选中内容类型，提供相应的功能选项
- **状态同步** - 格式刷、交叉引用等功能支持状态显示和实时更新
- **智能定位** - 表编号功能智能检测表格前段落情况，自动选择最佳插入位置，确保题注不会插入到表格单元格中

### 专业排版

- **表格布局** - 式编号采用表格布局，实现精确的居中对齐
- **自动编号** - 图、表、公式编号自动递增，支持章节关联
- **智能插入** - 表编号和式编号智能处理段落关系，避免误操作
  - 表编号：自动检测表格前段落，智能选择插入位置
  - 式编号：保留公式前的空行，不会删除段落
- **样式管理** - 完整的样式预设和管理功能，支持导入导出

### 高效编辑

- **批量处理** - 支持批量插入、批量替换、批量格式调整
- **符号库** - 丰富的符号和字母库，快速插入常用符号
- **文档操作** - 支持文档合并、拆分等批量操作

---

## 🎯 适用场景

### 学术写作

- 论文格式标准化
- 图表编号自动化
- 参考文献管理
- 多级标题设置
- 公式编号排版
- 密级标签添加

### 办公文档

- 文档格式统一
- 批量文本处理
- 表格样式规范
- 快速排版
- 文档拆分合并
- PDF 导出

### 技术文档

- 公式编号管理
- 交叉引用维护
- 符号快速插入
- 样式模板应用
- 图片处理优化

---

## 🔧 技术信息

### 技术架构

- **开发框架**：VSTO (Visual Studio Tools for Office)
- **开发语言**：C# 7.3
- **目标框架**：.NET Framework 4.0
- **Office API**：Microsoft.Office.Interop.Word

### 设计原则

- **Word API 优先** - 充分利用 Word 原生 API，确保稳定性和兼容性
- **模块化设计** - 功能模块独立，便于维护和扩展
- **简洁高效** - 代码简洁直接，避免不必要的抽象
- **向后兼容** - 支持 Windows 7 和 Office 2013 等较老版本

### 代码规范

- 遵循 VSTO 开发标准
- 优先使用 Word 自带 API 和内置命令
- 明确的命名空间引用
- 单一职责原则
- 完善的错误处理

---

## 📦 项目结构

```
WordMan_VSTO/
├── ThisAddIn.cs              # VSTO插件入口
├── MainRibbon.cs             # 功能区界面和事件处理
├── MainRibbon.Designer.cs    # 功能区界面设计器
├── CaptionManager.cs         # 题注和交叉引用管理
├── TextProcessor.cs          # 文本处理功能
├── TableProcessor.cs         # 表格处理功能
├── ImageProcessor.cs         # 图片处理功能
├── DocumentProcessor.cs      # 文档处理功能
├── ControlsManager.cs        # 控件管理系统
├── StyleTools/               # 样式和排版工具
│   ├── StyleSetting/         # 样式设置模块
│   ├── MultiLevel/           # 多级列表功能
│   └── TypesettingTaskPane.cs # 排版任务窗格
├── SplitAndMerge/            # 文档拆分合并
├── Syboms/                   # 符号工具（希腊字母、常用符号）
└── 功能介绍/                 # 功能展示图片
```

---

## 📄 许可证

本项目采用开源许可证，具体信息请查看项目根目录下的 LICENSE 文件。

---

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来帮助改进 WordMan 插件。您的反馈和建议对我们非常重要！

---

## 📞 支持与反馈

如有问题或建议，请通过以下方式联系：

- 提交 GitHub Issue
- 发送邮件反馈

---

<div align="center">

**WordMan 3.0** - 让 Word 文档处理更高效、更专业！

*Made with ❤️ for Word users*

</div>
