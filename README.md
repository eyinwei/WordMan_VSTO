# WordMan - Word 文档处理增强插件

WordMan 是一个功能强大的 Microsoft Word VSTO 插件，专为学术写作、文档排版和办公效率提升而设计。该插件基于 .NET Framework 4.0 开发，兼容 Windows 7 及以上系统和 Office 2013 及以上版本。

## 🚀 主要功能

### 📝 文本处理工具
- **清除格式** - 清除选中文本的所有格式（Word 内置功能）
- **格式刷** - 复制格式并应用到其他文本，支持状态保持（Word 内置功能）
- **只留文本** - 只粘贴文本内容，不保留任何格式（Word 内置功能）
- **去除断行** - 一键清除文档中的硬回车和软回车
- **去除空格** - 批量删除全角和半角空格
- **去除空行** - 智能识别并删除空白段落
- **去除缩进** - 快速清除段落缩进格式
- **缩进2字符** - 一键设置标准段落缩进
- **英中标点互转** - 智能转换中英文标点符号
- **自动加空格** - 在数字和单位之间自动添加空格

### 🔤 符号与字符工具
- **希腊字母** - 提供完整的希腊字母表，支持大小写转换和样式设置
- **常用符号** - 分类整理的科学符号、数学符号、单位符号等
- **快速密级** - 一键添加文档密级标签（公开、内部等）

### 📊 表格处理工具
- **三线表** - 快速创建和设置标准三线表格式
- **表编号** - 自动为表格添加题注，支持多种编号样式（表1、表1-1、表1.1）
- **插入N行/列** - 批量插入指定数量的表格行或列
- **重复标题行** - 在表格的每一页顶部重复标题行，支持状态保持（Word 内置功能）
- **宽度刷/高度刷** - 快速复制和应用图片/表格的尺寸
- **创建三线表** - 快速创建标准的三线表格式

### 📈 图表与编号
- **图编号** - 自动为图片添加题注，支持多种编号样式（图1、图1-1、图1.1）
- **式编号** - 智能式编号，使用表格布局实现居中显示和右对齐编号
- **表编号** - 自动为表格添加题注，支持多种编号样式（表1、表1-1、表1.1）
- **交叉引用高亮** - 智能识别并高亮显示文档中的交叉引用和文献引用
- **交叉引用插入** - 支持通过按钮状态切换和ESC键快速退出的交互式交叉引用插入
- **图片处理** - 包括图编号和尺寸刷功能

### 🎨 样式与排版
- **样式设置** - 全面的文档样式管理，支持样式预设和自定义
- **多级列表** - 强大的多级列表创建和管理工具，支持9级标题设置
- **排版工具** - 专业的排版任务窗格，集成常用排版功能
- **控件管理** - 智能的控件管理系统，支持单位转换和数值计算
- **快速密级** - 一键添加文档密级标签（公开、内部等）

### 📄 文档管理
- **文档拆分** - 按页拆分Word文档
- **文档合并** - 批量合并多个Word文档
- **PDF导出** - 一键导出为PDF格式
- **位图化** - 将矢量图形转换为位图格式
- **文档操作** - 集成文档拆分和合并功能

## 🖼️ 功能展示

### 主功能界面
![主功能](功能介绍/fig1%20主功能.png)

### 希腊字母工具
![希腊字母](功能介绍/fig2%20希腊字母.png)

### 常用符号工具
![常用符号](功能介绍/fig3%20常用符号.png)

### 排版工具
![排版工具](功能介绍/fig4%20排版工具.png)

### 样式设置
![样式设置](功能介绍/fig5%20样式设置.png)

### 多级列表
![多级列表](功能介绍/fig6%20多级列表.png)

### 多级列表段落设置
![多级列表段落设置](功能介绍/fig7%20多级列表段落设置.png)

## 🛠️ 技术特性

### 兼容性
- **框架版本**: .NET Framework 4.0
- **操作系统**: Windows 7 及以上
- **Office版本**: Microsoft Office 2013 及以上
- **开发语言**: C# 7.3

### 架构设计
- **VSTO架构** - 基于Visual Studio Tools for Office
- **模块化设计** - 功能模块独立，便于维护和扩展
- **Word API优先** - 充分利用Word原生API，确保稳定性和兼容性
- **内置功能集成** - 通过ExecuteMso直接调用Word内置命令，保持与系统行为一致
- **表格布局** - 式编号采用表格布局，实现精确的居中显示和右对齐

### 代码规范
- 遵循VSTO开发标准
- 优先使用Word自带API和内置命令
- 通过ExecuteMso调用Word内置功能，保持系统一致性
- 避免不必要的抽象
- 保持代码简洁直接
- 明确命名空间引用
- 方法职责单一，便于维护

## 📦 安装说明

### 系统要求
- Windows 7 或更高版本
- Microsoft Office 2013 或更高版本
- .NET Framework 4.0 或更高版本

### 安装步骤
1. 下载最新版本的WordMan插件
2. 确保已安装Microsoft Office
3. 运行安装程序
4. 重启Microsoft Word
5. 在Word功能区中查看"WordMan"选项卡

## ✨ 最新特性

### Word 内置功能集成
- **清除格式** - 一键清除选中文本的所有格式，使用Word内置命令
- **格式刷** - 智能格式刷功能，支持状态保持，自动检测格式应用完成
- **只留文本** - 只粘贴文本内容，不保留任何格式，支持剪贴板文本粘贴
- **重复标题行** - 表格标题行重复功能，支持状态同步，与Word系统行为完全一致
- **无缝集成** - 所有功能通过ExecuteMso调用Word内置命令，确保功能稳定可靠

### 式编号优化
- **表格布局** - 采用三列表格实现公式居中显示和编号右对齐
- **格式保持** - 完美保持公式的原有格式（字体、颜色、数学公式等）
- **多种样式** - 支持（1）、（1-1）、（1.1）三种编号格式
- **智能处理** - 自动处理段落标记，避免多余空白行
- **快速创建** - 一键创建标准式编号格式

### 交叉引用增强
- **智能识别** - 自动识别REF、HYPERLINK和EndNote文献引用
- **颜色区分** - 图（蓝色）、表（绿色）、公式（红色）、其他（紫色）
- **一键操作** - 支持一键高亮和取消高亮
- **交互优化** - 支持按钮状态显示和ESC键快速退出
- **智能插入** - 通过光标定位快速插入交叉引用

### 控件管理优化
- **单位转换** - 支持厘米、磅、字符、行等多种单位转换
- **数值计算** - 提供精确的数值计算功能
- **智能控件** - 自动创建和管理输入控件
- **位图化** - 将矢量图形转换为位图格式

## 🎯 使用场景

### 学术写作
- 论文格式标准化
- 图表编号自动化
- 参考文献管理
- 多级标题设置
- 式编号管理
- 密级标签添加

### 办公文档
- 文档格式统一
- 批量文本处理
- 表格样式规范（支持标题行重复）
- 格式快速清除和复制
- 纯文本粘贴功能
- 文档拆分合并
- 快速排版

### 技术文档
- 式编号管理
- 交叉引用维护
- 符号快速插入
- 样式模板应用
- 图片处理优化

## 🔧 开发信息

### 项目结构
```
WordMan_VSTO/
├── ThisAddIn.cs              # VSTO插件入口
├── MainRibbon.cs             # 功能区界面和核心功能
├── MainRibbon.Designer.cs    # 功能区界面设计器
├── ControlsManager.cs        # 控件管理系统
├── MultiLevel/               # 多级列表功能
│   ├── MultiLevelListForm.cs
│   ├── LevelStyleSettingsForm.cs
│   ├── MultiLevelDataManager.cs
│   └── WordStyleInfo.cs
├── StyleSetting/             # 样式设置模块
│   ├── StyleSettings.cs
│   ├── StyleFileManager.cs
│   ├── StylePresetManager.cs
│   ├── StyleSettings.Designer.cs
│   └── StyleSettingsUIDesigner.cs
├── SplitAndMerge/            # 文档拆分合并
│   ├── DocumentSplitter.cs
│   ├── DocumentMerger.cs
│   └── DocumentMergeForm.cs
├── Syboms/                   # 符号工具
│   ├── GreekLetterForm.cs
│   ├── CommonSymbolForm.cs
│   ├── GreekLetterForm.Designer.cs
│   └── CommonSymbolForm.Designer.cs
├── TypesettingTaskPane.cs    # 排版任务窗格
└── 功能介绍/                 # 功能展示图片
```

### 核心模块
- **MainRibbon** - 主功能区界面和事件处理，集成所有核心功能，包括Word内置功能集成
- **CaptionManager** - 题注和交叉引用管理，支持图、表、式编号
- **DocumentProcessor** - 文档处理功能，包括域名高亮、PDF导出、密级管理等
- **TextProcessor** - 文本处理功能，包括标点转换、空格处理等
- **TableProcessor** - 表格处理功能，包括三线表创建、行列插入等
- **ImageProcessor** - 图片处理功能，包括尺寸刷、位图化等
- **MultiLevelListForm** - 多级列表创建和管理，支持9级标题设置
- **StyleSettings** - 文档样式设置和管理，支持样式预设和自定义
- **DocumentSplitter/Merger** - 文档拆分合并功能，支持批量处理
- **GreekLetterForm** - 希腊字母输入工具，支持大小写转换
- **CommonSymbolForm** - 常用符号输入工具，分类整理科学符号
- **ControlsManager** - 控件管理系统，提供单位转换和数值计算
- **TypesettingTaskPane** - 排版任务窗格，集成常用排版功能

## 📄 许可证

本项目采用开源许可证，具体信息请查看项目根目录下的LICENSE文件。

## 🤝 贡献

欢迎提交Issue和Pull Request来帮助改进WordMan插件。

## 📞 支持

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件反馈

---

**WordMan** - 让Word文档处理更高效、更专业！